<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ramnog">
<title>Endpoint Catalog • ramnog</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Endpoint Catalog">
<meta property="og:description" content="ramnog">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ramnog</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/ramnog.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Overview</h6>
    <a class="dropdown-item" href="../articles/ep_overview.html">Endpoint Specification</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Endpoint Population and Outcome Specification</h6>
    <a class="dropdown-item" href="../articles/ep_spec_adam_data.html">ADaM Data</a>
    <a class="dropdown-item" href="../articles/ep_spec_treatment_arms.html">Treatment Arms</a>
    <a class="dropdown-item" href="../articles/ep_spec_population_def.html">Analysis Population</a>
    <a class="dropdown-item" href="../articles/ep_spec_event_def.html">Endpoint Events</a>
    <a class="dropdown-item" href="../articles/ep_spec_strata_def.html">Strata</a>
    <a class="dropdown-item" href="../articles/ep_spec_label.html">Endpoint Label</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Endpoint Statistics</h6>
    <a class="dropdown-item" href="../articles/methods_criteria.html">Criteria Methods</a>
    <a class="dropdown-item" href="../articles/methods_stat.html">Statistical Methods</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Endpoint Results</h6>
    <a class="dropdown-item" href="../articles/results_datamodel.html">Result Data Model</a>
    <a class="dropdown-item" href="../articles/results_datamodel2tfl.html">Mapping Results to TFLs</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Endpoint Examples</h6>
    <a class="dropdown-item" href="../articles/example_ep_spec.html">Endpoint Catalog</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Debugging</h6>
    <a class="dropdown-item" href="../articles/debugging.html">Debugging</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Development</h6>
    <a class="dropdown-item" href="../articles/dev_git.html">Git Workflow</a>
    <a class="dropdown-item" href="../articles/validation.html">Quality control for ramnog ecosystem</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Endpoint Catalog</h1>
            
      
      
      <div class="d-none name"><code>example_ep_spec.Rmd</code></div>
    </div>

    
    
<!-- ```{css, echo=FALSE} -->
<!-- pre { -->
<!--   max-height: 1000px; -->
<!--   overflow-y: auto; -->
<!-- } -->
<!-- pre[class] { -->
<!--   max-height: 650px; -->
<!-- } -->
<!-- ``` -->
<p>This vignette provides catalog of endpoint examples, derived endpoint
specifications and associated ADaM functions and statistical
functions.</p>
<p>The endpoints are grouped into three categories:</p>
<ul>
<li>Binary outcomes</li>
<li>Demographics</li>
<li>Continuous outcomes</li>
</ul>
<div class="section level2 tabset tabset-fade tabset-pills">
<h2 class="tabset tabset-fade tabset-pills" id="endpoint-types">Endpoint types<a class="anchor" aria-label="anchor" href="#endpoint-types"></a>
</h2>




<ul class="nav nav-pills" id="endpoint-types" role="tablist">
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#binary-type-1" id="binary-type-1-tab" type="button" role="tab" aria-controls="binary-type-1" aria-selected="true" class="active nav-link">Binary type 1</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#binary-type-2" id="binary-type-2-tab" type="button" role="tab" aria-controls="binary-type-2" aria-selected="false" class="nav-link">Binary type 2</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#demographics" id="demographics-tab" type="button" role="tab" aria-controls="demographics" aria-selected="false" class="nav-link">Demographics</button></li>
<li role="presentation" class="nav-item"><button data-bs-toggle="tab" data-bs-target="#continuous-outcomes" id="continuous-outcomes-tab" type="button" role="tab" aria-controls="continuous-outcomes" aria-selected="false" class="nav-link">Continuous outcomes</button></li>
</ul>
<div class="tab-content">
<div class="active show fade tab-pane" id="binary-type-1" role="tabpanel" aria-labelledby="binary-type-1-tab">

<p><img src="figures/ep_spec_mockup_binary.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>For the endpoints above, we note that the endpoint specification must
contain statistics both by strata and treatment arm (<code>N</code>,
<code>n</code>, <code>%</code>), by strata across treatment arms
(<code>RR</code>, <code>OR</code>, <code>P-value</code>) and across
strata and treatment arms (<code>P-value interaction</code>) which must
be calculated on two strata (<code>Age</code>, <code>Sex</code>). The
statistical functions will come from the library of statistical
functions in {chefStats}.</p>
<p>We assume the endpoint concerns adverse events and must be applied to
the full safety population set (<code>SAFFL="Y"</code>).</p>
<p>We also need the functions to produce the clinical data to pass to
the <code>data_prepare</code>. Since this examlple analyses adverse
events, we will need some version of the ADAE dataset. As these exact
nature of the clinical dataset will differ from project-to-project,
there is no library of data prep functions we can source from. Instead
we define our own example functions here:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merge ADSL and ADAE from {pharmaverseadam}</span></span>
<span><span class="va">mk_adae</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">study_metadata</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Read ADSL</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adsl.html" class="external-link">adsl</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Filter treatment arms</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="va">adsl</span><span class="op">[</span><span class="va">adsl</span><span class="op">$</span><span class="va">TRT01A</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="st">"Xanomeline High Dose"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># New derived ADSL age group variable</span></span>
<span>  <span class="va">adsl</span><span class="op">[</span>, <span class="va">AGEGR2</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">&lt;</span> <span class="fl">65</span>, <span class="st">"AGE &lt; 65"</span>,</span>
<span>    <span class="va">AGE</span> <span class="op">&gt;=</span> <span class="fl">65</span>, <span class="st">"AGE &gt;= 65"</span>,</span>
<span>    default <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Read ADAE</span></span>
<span>  <span class="va">adae</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adae.html" class="external-link">adae</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Merge ADSL and ADAE</span></span>
<span>  <span class="va">adam_out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">adae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">adae</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">)</span><span class="op">)</span>, <span class="st">"USUBJID"</span><span class="op">)</span>,</span>
<span>      with <span class="op">=</span></span>
<span>        <span class="cn">F</span></span>
<span>    <span class="op">]</span>, by <span class="op">=</span> <span class="st">"USUBJID"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">adam_out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Let us consider different variations of this endpoint specification
in the cases below. In the examples we demonstrate how to apply the
statistics either on the full population, by grouping on system organ
class (SOCs) and severity, and filtered on severity.</p>
<p>Note that the set of SOCs is trimmed according to an endpoint
criterion function (<code>ep_crit_min_subev_by_trt</code>), so that only
SOCs with at least 5 subjects with events in at least one treatment arm
are included. The criteria function will come from the library of
criteria functions found in {chefCriteria}.</p>
<div class="section level5">
<h5 id="case-1-adverse-events-base-form">Case 1: Adverse events (base form)<a class="anchor" aria-label="anchor" href="#case-1-adverse-events-base-form"></a>
</h5>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_adae</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj.html" class="external-link">n_subj</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj_event.html" class="external-link">n_subj_event</a></span>,</span>
<span>    <span class="fu">cheStats</span><span class="fu">::</span><span class="va">p_subj_event</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_by_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/RR.html" class="external-link">RR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/OR.html" class="external-link">OR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/p_val.html" class="external-link">p_val</a></span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_across_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va">pval_interaction</span><span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Adverse events - &lt;treatment_var&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="case-2-adverse-events-grouped-by-system-organ-class">Case 2: Adverse events grouped by system organ class<a class="anchor" aria-label="anchor" href="#case-2-adverse-events-grouped-by-system-organ-class"></a>
</h5>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_adae</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AESOC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj.html" class="external-link">n_subj</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj_event.html" class="external-link">n_subj_event</a></span>,</span>
<span>    <span class="fu">cheStats</span><span class="fu">::</span><span class="va">p_subj_event</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_by_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/RR.html" class="external-link">RR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/OR.html" class="external-link">OR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/p_val.html" class="external-link">p_val</a></span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_across_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va">pval_interaction</span><span class="op">)</span>,</span>
<span>  crit_endpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">ep_crit_min_subev_by_trt</span>,</span>
<span>      min_n_subev <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      requirement_type <span class="op">=</span> <span class="st">"any"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Adverse events - &lt;AESOC&gt; - &lt;treatment_var&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="case-3-mild-adverse-events-grouped-by-system-organ-class">Case 3: Mild adverse events grouped by system organ class<a class="anchor" aria-label="anchor" href="#case-3-mild-adverse-events-grouped-by-system-organ-class"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_adae</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  endpoint_filter <span class="op">=</span> <span class="st">'ASEV == "MILD"'</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AESOC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj.html" class="external-link">n_subj</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj_event.html" class="external-link">n_subj_event</a></span>,</span>
<span>    <span class="fu">cheStats</span><span class="fu">::</span><span class="va">p_subj_event</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_by_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/RR.html" class="external-link">RR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/OR.html" class="external-link">OR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/p_val.html" class="external-link">p_val</a></span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_across_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va">pval_interaction</span><span class="op">)</span>,</span>
<span>  crit_endpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">ep_crit_min_subev_by_trt</span>,</span>
<span>      min_n_subev <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      requirement_type <span class="op">=</span> <span class="st">"any"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Mild adverse events - &lt;treatment_var&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="case-4-adverse-events-grouped-by-severity-and-system-organ-class">Case 4: Adverse events grouped by severity and system organ
class<a class="anchor" aria-label="anchor" href="#case-4-adverse-events-grouped-by-severity-and-system-organ-class"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_adae</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ASEV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, AESOC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj.html" class="external-link">n_subj</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj_event.html" class="external-link">n_subj_event</a></span>,</span>
<span>    <span class="fu">cheStats</span><span class="fu">::</span><span class="va">p_subj_event</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_by_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/RR.html" class="external-link">RR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/OR.html" class="external-link">OR</a></span>,</span>
<span>    <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/p_val.html" class="external-link">p_val</a></span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_across_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va">pval_interaction</span><span class="op">)</span>,</span>
<span>  crit_endpoint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">ep_crit_min_subev_by_trt</span>,</span>
<span>      min_n_subev <span class="op">=</span> <span class="fl">5</span>,</span>
<span>      requirement_type <span class="op">=</span> <span class="st">"any"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"&lt;ASEV&gt; adverse events - &lt;AESOC&gt; - &lt;treatment_var&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="fade tab-pane" id="binary-type-2" role="tabpanel" aria-labelledby="binary-type-2-tab">

<p><img src="figures/binary_outcomes_type_2.PNG" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>To get results that match the table above, we can group the endpoints
by <code>AESOC</code>, and then within each <code>AESOC</code> grouping,
stratify by <code>AEDECOD</code>. By framing it as such, we can see that
we need a statistic (<code>n</code> number of subjects with an event and
<code>E</code> number of events) for every combination endpoint group
(<code>AESOC</code>) and stratification level (<code>AEDECOD</code>).
The statistical functions will come from chefStats.</p>
<p>We assume the endpoint concerns adverse events and must be applied to
the full safety population set (<code>SAFFL="Y"</code>).</p>
<p>We also need the functions to produce the clinical data to pass to
the data_prepare. Since this examlple analyses adverse events, we will
need some version of the ADAE dataset. As these exact nature of the
clinical dataset will differ from project-to-project, there is no
library of data prep functions we can source from. Instead we define our
own example functions here:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merge ADSL and ADAE from {pharmaverseadam}</span></span>
<span><span class="va">mk_adae</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">study_metadata</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Read ADSL</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adsl.html" class="external-link">adsl</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Filter treatment arms</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="va">adsl</span><span class="op">[</span><span class="va">adsl</span><span class="op">$</span><span class="va">TRT01A</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="st">"Xanomeline High Dose"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># New derived ADSL age group variable</span></span>
<span>  <span class="va">adsl</span><span class="op">[</span>, <span class="va">AGEGR2</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">&lt;</span> <span class="fl">65</span>, <span class="st">"AGE &lt; 65"</span>,</span>
<span>    <span class="va">AGE</span> <span class="op">&gt;=</span> <span class="fl">65</span>, <span class="st">"AGE &gt;= 65"</span>,</span>
<span>    default <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Read ADAE</span></span>
<span>  <span class="va">adae</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adae.html" class="external-link">adae</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Merge ADSL and ADAE</span></span>
<span>  <span class="va">adam_out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">adae</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">adae</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">)</span><span class="op">)</span>, <span class="st">"USUBJID"</span><span class="op">)</span>,</span>
<span>      with <span class="op">=</span></span>
<span>        <span class="cn">F</span></span>
<span>    <span class="op">]</span>, by <span class="op">=</span> <span class="st">"USUBJID"</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">adam_out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>    data_prepare <span class="op">=</span> <span class="va">mk_adae</span>,</span>
<span>    pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>    pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>    treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>    treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>    group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AESOC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AEDECOD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj_event.html" class="external-link">n_subj_event</a></span>,</span>
<span>                                 <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_event.html" class="external-link">n_event</a></span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="fade tab-pane" id="demographics" role="tabpanel" aria-labelledby="demographics-tab">

<p><img src="figures/ep_spec_mockup_demographics.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>This table contains both continuous variables (<code>Age</code>,
<code>Body Weight at Baseline</code>) and categorical variables
(<code>Age Group</code>, <code>Sex</code>) for which different
statistics are applied. So the endpoint will be split up in two endpoint
specifications, one for the continuous variables (case 5), and one for
the categorical variables (case 6).</p>
<p>For the categorical variables (<code>Age Group</code> and
<code>Sex</code>), we see that we need a statistic for each
stratification level of the category (e.g. <code>AGEGR1 &lt; 65</code>
and <code>AGEGR1 &gt;= 65</code>). So it is clear that to get the
results we need, we need one statistic per stratification level and
treatment level. Thus we will supply our statistical function to the
<code>stat_by_strata_by_trt</code> argument of our endpoint
specification.</p>
<p>For the continuous variables it is less obvious. However, if we
consider TOTAL to be a stratification just like age or sex, albeit with
only a single level, then we can see that here we also need one
statistic per strata level and treatment level, so will use the
<code>stat_by_strata_by_trt</code></p>
<p>In both cases a single statistical function is applied,
(<code><a href="https://hta-pharma.github.io/chefStats/reference/demographics_continuous.html" class="external-link">chefStats::demographics_continuous()</a></code> and
<code>chefStats::demographics_categorical()</code> respectively) which
compactly supplies all required statistics in one function call.
Alternatively, we can define separate functions for each statistics and
apply the individually in the endpoint specification.</p>
<p>We also need the functions to produce the clinical data to pass to
the <code>data_prepare</code>. Since this example analyzes body weight,
we will need some version of the ADVS dataset. As these exact nature of
the clinical dataset will differ from project-to-project, there is no
library of data prep functions we can source from. Instead we define our
own example that matches the needs of our analysis:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merge ADSL and ADVS from {pharmaverseadam}</span></span>
<span><span class="va">mk_advs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">study_metadata</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="co"># Read ADSL</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adsl.html" class="external-link">adsl</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Filter treatment arms</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="va">adsl</span><span class="op">[</span><span class="va">adsl</span><span class="op">$</span><span class="va">TRT01A</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="st">"Xanomeline High Dose"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># New derived ADSL age group variable</span></span>
<span>  <span class="va">adsl</span><span class="op">[</span>, <span class="va">AGEGR2</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">&lt;</span> <span class="fl">65</span>, <span class="st">"AGE &lt; 65"</span>,</span>
<span>    <span class="va">AGE</span> <span class="op">&gt;=</span> <span class="fl">65</span>, <span class="st">"AGE &gt;= 65"</span>,</span>
<span>    default <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span>  <span class="co"># Read ADVS</span></span>
<span>  <span class="va">advs</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/advs.html" class="external-link">advs</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Identify baseline body weight</span></span>
<span>  <span class="va">advs_bw</span> <span class="op">&lt;-</span> <span class="va">advs</span><span class="op">[</span><span class="va">advs</span><span class="op">$</span><span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"WEIGHT"</span> <span class="op">&amp;</span> <span class="va">advs</span><span class="op">$</span><span class="va">VISIT</span> <span class="op">==</span> <span class="st">"BASELINE"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Create new variable BW_BASELINE</span></span>
<span>  <span class="va">advs_bw</span><span class="op">[[</span><span class="st">"BW_BASELINE"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">advs_bw</span><span class="op">[[</span><span class="st">"AVAL"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Merge ADSL, ADAE and baseline body weight from ADVS</span></span>
<span>  <span class="va">adam_out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">advs_bw</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BW_BASELINE"</span>, <span class="st">"USUBJID"</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"USUBJID"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">adam_out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We show how to define demographic endpoints for both continuous
variables and categorical variables</p>
<div class="section level5">
<h5 id="case-1-baseline-characteristics-of-analysis-population-continuous-variables">Case 1: Baseline characteristics of analysis population (continuous
variables)<a class="anchor" aria-label="anchor" href="#case-1-baseline-characteristics-of-analysis-population-continuous-variables"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_advs</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">demographics_continuous</span>,</span>
<span>      var <span class="op">=</span> <span class="st">"AGE"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">demographics_continuous</span>,</span>
<span>      var <span class="op">=</span> <span class="st">"BW_BASELINE"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Demographics endpoint (categorical measures)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="case-2-baseline-characteristics-of-analysis-population-categorical-variables">Case 2: Baseline characteristics of analysis population (categorical
variables)<a class="anchor" aria-label="anchor" href="#case-2-baseline-characteristics-of-analysis-population-categorical-variables"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_advs</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_var <span class="op">=</span> <span class="st">"SAFFL"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span>, <span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">demographics_counts</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Demographics endpoint (categorical measures)"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We then collect the two endpoint specifications to cover the complete
endpoint:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ep_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ep_spec_pt1</span>, <span class="va">ep_spec_pt2</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="fade tab-pane" id="continuous-outcomes" role="tabpanel" aria-labelledby="continuous-outcomes-tab">

<p><img src="figures/ep_spec_mockup_continuous.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
<p>The table above contains statistics on baseline characteristics, as
well as change-from-baseline. We observe that mean and SD are calculated
on each combination of treatment arm, strata (total and age), time
(baseline, week 8 and 16). By defining time (<code>AVISIT</code>) as the
endpoint grouping we can obtain all the statistics in one endpoint
specification. This implies that:</p>
<ul>
<li>The mean and SD are calculated by treatment and strata levels
(<code>stat_by_strata_by_trt</code>) on both the analysis data columns
containing the baseline (<code>VALUE_BASELINE</code>) and change from
baseline column (<code>VALUE_CHANGE</code>).</li>
<li>Number of subjects (<code>N</code>) is also calculated by treatment
and strata level (<code>stat_by_strata_by_trt</code>).</li>
<li>For each endpoint grouping (<code>AVISIT</code>) Hedge’s G is
calculated by each strata level and across treatment arms
(<code>stat_by_strata_across_trt</code>).</li>
</ul>
<p>We also need the functions to produce the clinical data to pass to
the <code>data_prepare</code>. Since this example analyses laboratory
data, we will need some version of the ADLB dataset. As these exact
nature of the clinical dataset will differ from project-to-project,
there is no library of data prep functions we can source from. Instead
we define our own example that matches the needs of our analysis:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Merge ADSL and ADLB from {pharmaverseadam}</span></span>
<span><span class="va">mk_adlb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">study_metadata</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Read ADSL</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adsl.html" class="external-link">adsl</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Filter treatment arms</span></span>
<span>  <span class="va">adsl</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">adsl</span><span class="op">[</span><span class="va">adsl</span><span class="op">$</span><span class="va">TRT01A</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Placebo"</span>, <span class="st">"Xanomeline High Dose"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># New derived ADSL age group variable</span></span>
<span>  <span class="va">adsl</span><span class="op">[</span>, <span class="va">AGEGR2</span> <span class="op">:=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">&lt;</span> <span class="fl">65</span>, <span class="st">"AGE &lt; 65"</span>,</span>
<span>    <span class="va">AGE</span> <span class="op">&gt;=</span> <span class="fl">65</span>, <span class="st">"AGE &gt;= 65"</span>,</span>
<span>    default <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Read ADLB</span></span>
<span>  <span class="va">adlb_0</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">pharmaverseadam</span><span class="fu">::</span><span class="va"><a href="https://pharmaverse.github.io/pharmaverseadam/main/reference/adlb.html" class="external-link">adlb</a></span><span class="op">)</span></span>
<span>  <span class="va">adlb_1</span> <span class="op">&lt;-</span> <span class="va">adlb_0</span><span class="op">[</span><span class="va">adlb_0</span><span class="op">[[</span><span class="st">"PARAMCD"</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"SODIUM"</span> <span class="op">&amp;</span></span>
<span>      <span class="va">adlb_0</span><span class="op">[[</span><span class="st">"AVISIT"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Week 8"</span>, <span class="st">"Week 16"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>  <span class="va">adlb2</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">adlb_1</span>,</span>
<span>      <span class="va">adlb_1</span><span class="op">[</span><span class="va">adlb_1</span><span class="op">$</span><span class="va">AVISIT</span> <span class="op">==</span> <span class="st">"Baseline"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USUBJID"</span>, <span class="st">"AVAL"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"USUBJID"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="va">adlb2</span><span class="op">[[</span><span class="st">"VALUE_BASELINE"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adlb2</span><span class="op">[[</span><span class="st">"AVAL.y"</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">adlb2</span><span class="op">[[</span><span class="st">"VALUE_CHANGE"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">adlb2</span><span class="op">[[</span><span class="st">"AVAL.x"</span><span class="op">]</span><span class="op">]</span> <span class="op">-</span> <span class="va">adlb2</span><span class="op">[[</span><span class="st">"AVAL.y"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Merge ADSL and ADLB</span></span>
<span>  <span class="va">adam_out</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">adsl</span>, <span class="va">adlb2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"USUBJID"</span>,</span>
<span>      <span class="st">"PARAMCD"</span>,</span>
<span>      <span class="st">"AVISIT"</span>,</span>
<span>      <span class="st">"VALUE_BASELINE"</span>,</span>
<span>      <span class="st">"VALUE_CHANGE"</span>,</span>
<span>      <span class="st">"ANL01FL"</span></span>
<span>    <span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"USUBJID"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">adam_out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The endpoint specification showing “summary statistics on baseline
and change from baseline” is shown below</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">chef</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/chef/man/mk_endpoint_str.html" class="external-link">mk_endpoint_str</a></span><span class="op">(</span></span>
<span>  data_prepare <span class="op">=</span> <span class="va">mk_adlb</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="st">"TRT01A"</span>,</span>
<span>  treatment_refval <span class="op">=</span> <span class="st">"Xanomeline High Dose"</span>,</span>
<span>  pop_value <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>AVISIT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stratify_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGEGR2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  stat_by_strata_by_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"n_sub"</span> <span class="op">=</span> <span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/n_subj.html" class="external-link">n_subj</a></span>,</span>
<span>    <span class="st">"mean: VALUE_BASELINE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/mean_value.html" class="external-link">mean_value</a></span>, var <span class="op">=</span> <span class="st">"VALUE_BASELINE"</span><span class="op">)</span>,</span>
<span>    <span class="st">"mean: VALUE_CHANGE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/mean_value.html" class="external-link">mean_value</a></span>, var <span class="op">=</span> <span class="st">"VALUE_CHANGE"</span><span class="op">)</span>,</span>
<span>    <span class="st">"sd: VALUE_BASELINE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/sd_value.html" class="external-link">sd_value</a></span>, var <span class="op">=</span> <span class="st">"VALUE_BASELINE"</span><span class="op">)</span>,</span>
<span>    <span class="st">"sd: VALUE_CHANGE"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">chefStats</span><span class="fu">::</span><span class="va"><a href="https://hta-pharma.github.io/chefStats/reference/sd_value.html" class="external-link">sd_value</a></span>, var <span class="op">=</span> <span class="st">"VALUE_CHANGE"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stat_by_strata_across_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">hedgesg</span><span class="op">)</span>,</span>
<span>  endpoint_label <span class="op">=</span> <span class="st">"Baseline and change from baseline on SODIUM - &lt;AVISIT&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by MEWP (Matthew David Phelps), NOSJ (Nicolai Skov Johnsen), HSPU (Henrik Sparre Spiegelhauer), CINO (Christian Haargaard Olsen).</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
